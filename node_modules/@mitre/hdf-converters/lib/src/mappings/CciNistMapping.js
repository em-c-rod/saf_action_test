"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.CciNistMapping = void 0;
const cci_nist_mapping_json_1 = __importDefault(require("../../data/cci-nist-mapping.json"));
const CciNistMappingItem_1 = require("./CciNistMappingItem");
class CciNistMapping {
    constructor() {
        this.data = [];
        if (typeof cci_nist_mapping_json_1.default === 'object') {
            Object.entries(cci_nist_mapping_json_1.default).forEach((item) => {
                this.data.push(new CciNistMappingItem_1.CciNistMappingItem(item[0], item[1]));
            });
        }
    }
    nistFilter(identifiers, defaultNist, collapse = true) {
        const DEFAULT_NIST_TAG = defaultNist;
        const matches = [];
        identifiers.forEach((id) => {
            const item = this.data.find((element) => element.cci === id);
            if (item && item.nistId) {
                if (collapse) {
                    if (matches.indexOf(item.nistId) === -1) {
                        matches.push(item.nistId);
                    }
                }
                else {
                    matches.push(item.nistId);
                }
            }
        });
        if (matches.length === 0) {
            return DEFAULT_NIST_TAG;
        }
        return matches;
    }
}
exports.CciNistMapping = CciNistMapping;
//# sourceMappingURL=CciNistMapping.js.map